# ***Study Notes***

***Common malware types (what they do)***

* ***Trojan:** masquerades as legit app; drops backdoors/stealers.*

* ***Ransomware:** encrypts files; ransom note \+ network share traversal.*

* ***Worm:** self-propagates (e.g., via SMB/RDP) without user action.*

* ***File infector:** injects code into .exe/.dll and corrupts apps.*

* ***Spyware/stealer:** exfiltrates creds, cookies, keystrokes.*

* ***Rootkit:** hides processes/files; persistence & evasion.*

***Infiltration vectors***

* *Phishing (malicious attachments/links), drive-by downloads, malvertising, **RDP/SSH brute force**, supply-chain (tampered installers), removable media (USB).*

***Early symptoms***

* *Sudden CPU/disk spikes, new startup entries/services, unsigned processes, blocked AV updates, DNS to odd domains, files with new extensions, ransom notes.*

***Persistence spots (Windows)***

* *HKCU/HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run*

* *Scheduled Tasks, Services, Startup folders, WMI subscriptions.*

***Useful Windows Event IDs***

* ***4688** (process create), **4624** (logon), **4672** (privileged logon),*

* ***4104** (PowerShell), **7036** (service state changes).*

***Captured Command Line (sample outputs)***

*These are **example** captures you can paste into your report; replace with real lab outputs when you run them.*

### ***Windows (PowerShell)***

***Running processes \+ company/signing***

*Get-Process | Select Name,Id,Path | Sort Name*

***Sample excerpt-***

*Name          Id    Path*

*\----          \--    \----*  
*chrome        5148  C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe*  
*AcroRd32      6740  C:\\Program Files\\Adobe\\Acrobat\\AcroRd32.exe*  
*svchost       1012  C:\\Windows\\System32\\svchost.exe*  
*updatehelper  7428  C:\\Users\\User\\AppData\\Roaming\\upd\\updatehelper.exe   \<-- suspicious (user profile)*

***Active network connections-** Get-NetTCPConnection | Where State \-eq Established | Select LocalAddress,LocalPort,RemoteAddress,RemotePort,OwningProcess*

*Sample excerpt*  
*LocalAddress LocalPort RemoteAddress   RemotePort OwningProcess*  
*\------------ \--------- \-------------   \---------- \-------------*  
*192.168.1.10 49822     104.21.7.180    443        7428  \<-- maps to updatehelper.exe*

***Autoruns (basic)-** Get-ItemProperty 'HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run','HKLM:\\...\\Run' | Select PSPath, \* | Out-String*

*Sample excerpt- HKCU...\\Run : "Updater"="C:\\Users\\User\\AppData\\Roaming\\upd\\updatehelper.exe"*

***Recent PowerShell script blocks (Event 4104)-** Get-WinEvent \-LogName "Microsoft-Windows-PowerShell/Operational" \-MaxEvents 10 | Select TimeCreated,Id,Message*

### ***Linux (Bash)***

***Processes listening & established***

*ss \-tup*

*Sample excerpt*

*ESTAB  0  0  10.0.0.15:49822  185.199.109.153:https  users:(("upd-helper",pid=2144,fd=11))*

***Recently modified binaries in \~/Downloads-** find \~/Downloads \-type f \-mtime \-2 \-exec ls \-lah {} \\;*

***Cron & systemd persistence-** crontab \-l ls \-lah /etc/cron.\* /etc/systemd/system | sed \-n '1,20p'*

***Hash suspicious files-** sha256sum \~/Downloads/\* | tee hashes.txt*

# ***Example Artifacts (drop-in screenshots/notes)***

* ***Run key**: HKCU\\...\\Run\\Updater \-\> C:\\Users\\User\\AppData\\Roaming\\upd\\updatehelper.exe*

* ***New scheduled task**: \\UpdaterDaily running updatehelper.exe every hour.*

* ***Event 4688**: Parent: winword.exe Child: powershell.exe \-enc ...*

* ***Ransom note**: C:\\Users\\User\\Desktop\\READ\_ME.txt (if ransomware scenario).*

* ***Hashes recorded**: updatehelper.exe ⇒ SHA256: 5fa…c2e*

***Safe Blue-Team Scripts (triage & evidence collection)***

### ***1\) PowerShell: quick triage (processes, netconns, autoruns, hashes)***

*\# Save as triage.ps1 (run as admin if possible)*  
*$Out \= "$env:USERPROFILE\\Desktop\\triage\_$(Get-Date \-Format yyyyMMdd\_HHmmss)"*  
*New-Item \-Type Directory \-Path $Out | Out-Null*  
*\# Processes \+ paths*  
*Get-Process | Select Name,Id,Path,StartTime \-ErrorAction SilentlyContinue \`*  
 *| Sort Name | Tee-Object "$Out\\processes.csv"*  
*\# Net connections*  
*Get-NetTCPConnection | Select State,LocalAddress,LocalPort,RemoteAddress,RemotePort,OwningProcess \`*  
 *| Tee-Object "$Out\\netconns.csv"*  
*\# Map PID \-\> Path*  
*$procMap \= Get-Process \-ErrorAction SilentlyContinue | Group Id \-AsHashTable \-AsString*  
*(Get-NetTCPConnection | Where RemoteAddress).ForEach({*  
    *$pid \= $\_.OwningProcess*  
    *$path \= if ($procMap.ContainsKey("$pid")) { $procMap\["$pid"\]\[0\].Path } else { "" }*  
*\[pscustomobject\]@{PID=$pid;Remote=$\_.RemoteAddress;RPort=$\_.RemotePort;Path=$path}*  
*}) | Tee-Object "$Out\\pid\_remote\_map.csv"*  
*\# Autorun (Run keys)*  
*'HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run','HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' |*  
 *ForEach-Object {*  
  *Try { Get-ItemProperty $\_ | Out-File \-Append "$Out\\autoruns.txt" } Catch {}*  
 *}*  
*\# Hash recent executables in user profile*  
*Get-ChildItem $env:USERPROFILE \-Recurse \-Include \*.exe,\*.dll \-ErrorAction SilentlyContinue |*  
 *Where-Object {$\_.LastWriteTime \-gt (Get-Date).AddDays(-7)} |*  
 *Get-FileHash \-Algorithm SHA256 | Export-Csv "$Out\\recent\_hashes.csv" \-NoTypeInformation*

*Write-Host "Triage saved to: $Out"*

***2\) Bash: userland triage (no root required)***  
*\# Save as triage.sh; run: bash triage.sh*  
*OUT="$HOME/triage\_$(date \+%Y%m%d\_%H%M%S)"*  
*mkdir \-p "$OUT"*

*ps aux \> "$OUT/processes.txt"*  
*ss \-tup \> "$OUT/netconns.txt" 2\>/dev/null*  
*crontab \-l \> "$OUT/crontab.txt" 2\>/dev/null*  
*find "$HOME" \-type f \-mtime \-2 \-name "\*.sh" \-o \-name "\*.py" \-o \-name "\*.exe" \> "$OUT/recent\_files.txt"*  
*grep \-R \--binary-files=without-match \-nE "curl|wget|powershell|Invoke-WebRequest" "$HOME" 2\>/dev/null \> "$OUT/sus\_calls.txt"*  
*find "$HOME/Downloads" \-maxdepth 1 \-type f \-print0 | xargs \-0 sha256sum \> "$OUT/download\_hashes.txt" 2\>/dev/null*

*echo "Triage saved to: $OUT"*

### 

### 

### 

### 

### 

### 

### 

### 

### ***3\) Python (cross-platform): hash a folder & emit CSV***

*\# hashdir.py  (python3 hashdir.py /path/to/folder out.csv)*  
*import sys, os, hashlib, csv, time*  
*def sha256(p, buf=8192):*  
    *h=hashlib.sha256()*  
    *with open(p,'rb') as f:*  
        *while True:*  
            *b=f.read(buf)*  
            *if not b: break*  
            *h.update(b)*  
    *return h.hexdigest()*

*folder=sys.argv\[1\] if len(sys.argv)\>1 else "."*  
*out=sys.argv\[2\] if len(sys.argv)\>2 else f"hashes\_{int(time.time())}.csv"*  
*rows=\[\]*  
*for root,\_,files in os.walk(folder):*  
    *for fn in files:*  
        *p=os.path.join(root,fn)*  
        *try:*  
            *rows.append(\[p, sha256(p), os.path.getsize(p)\])*  
        *except Exception: pass*  
*with open(out,"w",newline="") as f:*  
    *w=csv.writer(f); w.writerow(\["path","sha256","size"\]); w.writerows(rows)*  
*print(f"Wrote {out}")*  
